"use strict";(self.webpackChunkswarm=self.webpackChunkswarm||[]).push([[398],{73251:function(e,t,r){function n(e){Object.keys(e).forEach((function(t){document[t]=e[t]}))}r.d(t,{Z:function(){return n}})},65802:function(e,t,r){var n=r(28889),a=r(45697),i=r.n(a),c=r(67294),l=r(22318),o=r(32427),u=r(28216),s=r(868),m=(0,o.Z)((function(e){return{tabCount:{borderRadius:e.spacing(.25),padding:e.spacing(0,.625,.125,.625),backgroundColor:e.palette.colors.grey[300],color:e.palette.colors.white[0],height:e.spacing(2),position:"relative",top:e.spacing(.25),"& .bolder":{position:"relative",bottom:e.spacing(.25),lineHeight:e.spacing(.225),verticalAlign:"baseline"}}}})),f=function(e){var t=e.countSelector,r=e.tooltip,a=m(),i=(0,u.v9)(t);return c.createElement(s.ZP,{title:r,arrow:!0,placement:"top",className:"manual-tooltip"},c.createElement(n.Z,{ml:1.2,className:"tabCount ".concat(a.tabCount),display:"inline-block"},c.createElement(l.Z,{variant:"caption",className:"bolder"},i||0===i?i:"-")))};t.Z=f,f.propTypes={countSelector:i().func.isRequired,tooltip:i().oneOfType([i().string,i().number])},f.defaultProps={tooltip:""}},56398:function(e,t,r){r.r(t),r.d(t,{default:function(){return ae}});var n=r(67294),a=r(41749),i=r(26793),c=r(45697),l=r.n(c),o=r(28216),u=r(90486),s=r(70065),m=r(41423),f=r(28889),p=r(32427),d=r(22318),v=r(71476),h=function(e,t,r){var n=t.reviewList?t.reviewList[e]:null;return n&&n.filters?r?n.filters[r]:n.filters:void 0},y=function(e,t,r){var n=t.reviewList?t.reviewList[e]:null;return n&&n[r]?n[r]:void 0},b=function(e,t){var r=Object.keys(t).filter((function(e){return t[e]})),n={};return r.length>0&&(n[e]=r),n},w=function(e,t){var r={};return t&&(r[e]=t),r},g=r(74489),E=r(66787);function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var S=function(e){var t=e.query,r=e.method,a=e.current,i=(0,n.useContext)(g.ZP).config.reviews,c=i&&i.filters&&i.filters["filter-max"]||50,l=(0,o.v9)((function(e){return h(t,e,"state")})),u=(0,o.v9)((function(e){return h(t,e,"votes")})),s=(0,o.v9)((function(e){return h(t,e,"commented")})),m=(0,o.v9)((function(e){return h(t,e,"testStatus")})),f=(0,o.v9)(E.p),p=(0,o.v9)((function(e){return h(t,e,"project")})),d=(0,o.v9)((function(e){return h(t,e,"branch")})),Z=(0,o.v9)((function(e){return h(t,e,"hasReviewer")})),S=(0,o.v9)((function(e){return y(t,e,"after")})),F=(0,o.v9)((function(e){return h(t,e,"userRole")})),N=(0,o.v9)((function(e){return h(t,e,"search")})),P=(0,o.v9)((function(e){return y(t,e,"dateField")})),k=(0,n.useMemo)((function(){return function(e){var t=e.project,r=e.projectFilter,n=e.branchFilter,a=e.states,i=e.votes,c=e.commented,l=e.testStatus,o=e.hasReviewer,u=e.after,s=e.userRole,m=e.search,f=e.dateField;return{target:"reviews",queryParams:j(j(j(j(j(j(j(j(j({max:e.max,metadata:!0},t?{project:(null!=n?n:[]).length?n.map((function(e){return t.concat(":").concat(e)})):t}:r?w("project",r):{}),b("state",a)),b("hasVoted",i)),w("myComments",c)),w("testStatus",l)),w("hasReviewer",o)),w("keywords",m)),"updated"===f?j(j({resultOrder:"updated"},(u.id?{lastSorted:u.id}:{})||""),(u.updated?{afterUpdated:u.updated}:{})||""):w("after",u.id)),s.roles&&s.User?O({},s.roles.join(""),s.User):{})}}({project:f,projectFilter:p,branchFilter:d,states:l,votes:u,commented:s,testStatus:m,hasReviewer:Z,after:S,max:c,userRole:F,search:N,dateField:P||i.filters.date_field})}),[f,p,d,l,u,s,m,Z,S,c,F,N,P]),T=k.target,C=k.queryParams;return(0,v.ib)(T,{queryParams:C,method:r,current:a})},F=S;S.propTypes={query:l().oneOf(["open","closed"]),method:l().oneOf(["GET"]),current:l().number},S.defaultProps={query:"open",method:"GET",current:null};var N=r(28358),P=r(41120),k=r(47006),T=r(59031),C=r(12877),R=r(64460),I=function(e){var t=e.project,r=(0,k.Z)({project:t,fields:["branches"],useSwarmCache:!0,empty:!1}),a=r.data,c=r.fetching,l=(0,o.I0)(),u=(0,i.$)(["review","project"]).t,s=(0,n.useMemo)((function(){return n.createElement(d.Z,{variant:"body2",className:"small list-group group-atoz"},u("project:aToz"))})),m=(0,n.useMemo)((function(){return(a&&a.projects&&0!==a.projects.length&&a.projects[0].branches?a.projects[0].branches:c?[{id:"loading",name:""}]:[]).sort((function(e,t){return-t.name.localeCompare(e.name)}))}),[a,t]),p=(0,o.v9)(R.ie);return n.createElement(f.Z,{className:"reviewBranchFilter"},n.createElement(C.Z,{tooltipText:u("project:branchFilterTooltip"),multiple:!0,optionsArray:m,searchText:"name",verifySelectedOption:function(e,t){return null===e.id||e.id===t.id},selectedValue:function(){var e=[];if(null!==p)for(var t=0;t<m.length;t+=1)p.includes(m[t].id)&&e.push(m[t]);return e}(),placeholderValue:u("project:allBranches"),placeholderLabel:u("project:branch"),groupBy:function(e){return e.groupBy||s},optionLabel:"name",onChange:function(e,t){var r=[];Object.values(t).forEach((function(e){r.push(e.id)})),l((0,T.t1)(r))},classNamePrefix:"branch"}))},q=I;I.propTypes={project:l().string.isRequired};var x=r(86675),z=(0,n.lazy)((function(){return(0,x.Z)((function(){return r.e(819).then(r.bind(r,15819))}))})),B=(0,n.lazy)((function(){return(0,x.Z)((function(){return r.e(206).then(r.bind(r,64206))}))})),A=(0,n.lazy)((function(){return(0,x.Z)((function(){return r.e(852).then(r.bind(r,94852))}))})),L=(0,n.lazy)((function(){return(0,x.Z)((function(){return r.e(66).then(r.bind(r,16066))}))})),H=(0,n.lazy)((function(){return(0,x.Z)((function(){return r.e(73).then(r.bind(r,52073))}))})),U=(0,n.lazy)((function(){return(0,x.Z)((function(){return r.e(55).then(r.bind(r,44055))}))})),M=(0,n.lazy)((function(){return(0,x.Z)((function(){return r.e(233).then(r.bind(r,36233))}))})),V=(0,n.lazy)((function(){return(0,x.Z)((function(){return r.e(658).then(r.bind(r,85658))}))})),$=(0,P.Z)((function(e){return{reviewFilterBar:{paddingTop:e.spacing(1.75),minHeight:0},reviewFilterGrid:{marginBottom:e.spacing(.5)}}})),G=function(e){var t=e.variant,r=(0,o.v9)(E.p),i=$();return n.createElement(N.Z,{variant:"dense",disableGutters:!0,className:"filterBar reviewFilterBar ".concat(t,"FilterBar ").concat(i.reviewFilterBar)},n.createElement(a.Z,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,className:i.reviewFilterGrid},n.createElement(n.Suspense,{fallback:null},r?n.createElement(a.Z,{key:"branchProject",item:!0,className:"reviewFilter"},n.createElement(q,{project:r})):n.createElement(a.Z,{key:"filterProject",item:!0,className:"reviewFilter"},n.createElement(U,null)),n.createElement(a.Z,{key:"filterUserRole",item:!0,className:"reviewFilter"},n.createElement(M,null)),"closed"!==t&&n.createElement(a.Z,{key:"filterHasReviewer",item:!0,className:"reviewFilter"},n.createElement(L,null)),n.createElement(a.Z,{key:"filterState",item:!0,className:"reviewFilter"},n.createElement(H,{variant:t})),n.createElement(a.Z,{key:"filterTest",item:!0,className:"reviewFilter"},n.createElement(z,null)),n.createElement(a.Z,{key:"filterCommented",item:!0,className:"reviewFilter"},n.createElement(B,null)),n.createElement(a.Z,{key:"filterVote",item:!0,className:"reviewFilter"},n.createElement(A,null)),n.createElement(a.Z,{key:"filterClear",item:!0,className:"reviewFilter"},n.createElement(V,null)))))},D=G;function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}G.propTypes={variant:l().oneOf(["open","closed"])},G.defaultProps={variant:"open"};var J=(0,n.lazy)((function(){return(0,x.Z)((function(){return Promise.all([r.e(138),r.e(393),r.e(961),r.e(823)]).then(r.bind(r,74823))}))})),K=function(){var e,t,r=(0,o.v9)(R.MA),a=r.dateField,i=r.query,c=r.after,l=(0,n.useMemo)((function(){return["author","description",a,"state","testStatus","complexity","comments","votes"]}),[a]),u=F({query:i}),s=u.data,m=u.fetching,p=u.messages,d=(e=(0,n.useState)(null),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],c=!0,l=!1;try{for(r=r.call(e);!(c=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{c||null==r.return||r.return()}finally{if(l)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Q(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=d[0],h=d[1],y=(0,o.I0)();return(0,n.useEffect)((function(){("created"===a||s&&s.reviews)&&y((0,T.RV)({query:i,count:s?{totalCount:s.totalCount,reviewCount:s.reviews.length,lastSeen:s.lastSeen,afterUpdated:s.afterUpdated}:null})),s&&s.reviews?h(((c.id||c.updated)&&v||[]).concat(s.reviews)):s||c.id||c.updated||h(null)}),[s]),n.createElement(f.Z,{className:"reviewQueryPanel ".concat(i,"Query")},n.createElement(n.Suspense,{fallback:null},n.createElement(D,{variant:i}),n.createElement(J,{loading:m,fields:l,reviews:v,messages:p})))},_=r(65802),W=r(47878),X=function(){var e=(0,i.$)(["review"]).t,t=(0,o.I0)(),r=(0,o.v9)(R.$4)||"";return n.createElement(W.Z,{changeHandler:function(e){t((0,T.qP)(e))},placeholder:e("searchForReview"),classes:"reviewSearch",defaultValue:r})},Y=(0,p.Z)((function(e){return{swarm:{"& button.reviewTab":{marginRight:e.spacing(4)}}}})),ee=function(){var e=(0,i.$)("review").t,t=Y(),r=(0,o.v9)(R.cE),c=(0,o.I0)();return n.createElement(n.Fragment,null,n.createElement(a.Z,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center"},n.createElement(a.Z,{item:!0,key:"reviewTabs"},n.createElement(s.Z,{className:"reviewTabs ".concat(t.swarm),value:r,onChange:function(e,t){c((0,T.t3)(t))},indicatorColor:"primary"},n.createElement(m.Z,{value:"open",className:"reviewTab openTab",label:n.createElement(f.Z,{className:"reviewOpen"},n.createElement(d.Z,{className:"medium bolder",variant:"body2"},e("open")),n.createElement(_.Z,{countSelector:R.x2}))}),n.createElement(m.Z,{value:"closed",className:"reviewTab closedTab",label:n.createElement(f.Z,{className:"reviewClosed"},n.createElement(d.Z,{className:"medium bolder",variant:"body2"},e("closed")),n.createElement(_.Z,{countSelector:R.fO}))}))),n.createElement(a.Z,{item:!0,key:"reviewSearchFilter"},n.createElement(X,null))),n.createElement(K,null))},te=r(73251),re=r(61125),ne=function(e){var t=(0,(0,i.$)("review").t)("reviews"),r=e.projectId,c=e.location,l=c.search,s=c.hash,m="Swarm ".concat(r?"- ".concat(r.replace(/-/g," ")," "):"","- ").concat(t," ");(0,te.Z)({title:m});var f=(0,o.I0)(),p=(0,o.v9)(R.b),d=p.openSearch,v=p.openHash,h=p.closedSearch,y=p.closedHash,b=p.activeQuery;return(0,n.useEffect)((function(){if(l||s){var e=(0,re.Z)(),t=e.mapLegacyHash,r=e.mapLegacySearchParams;f((0,T.KJ)({location:{search:r(l,"reviews"),hash:t(s,"reviews")}}))}else(d||h||v||y)&&f((0,T.KJ)({location:{search:"",hash:""}}))}),[l,s]),"dashboard"===b&&f((0,T.t3)("open")),n.createElement(a.Z,null,n.createElement(u.default,{title:"reviews"}),n.createElement(ee,null))},ae=ne;ne.propTypes={projectId:l().string,location:l().objectOf(l().oneOfType([l().any]))},ne.defaultProps={projectId:null,location:{}}}}]);