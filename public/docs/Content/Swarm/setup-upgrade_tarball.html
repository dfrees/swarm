<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Side_Nav___Swarm" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" /><title>Upgrading a tarball installation</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/perforce.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.print-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.remove-highlight-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.previous-topic-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE.htc');
}

</style>
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>/* <![CDATA[ */		/*The following script overrides topic title in browser tab*/
			document.title = "Helix Swarm Guide (2022.1)";
		/* ]]> */</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 980px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="home-swarm.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div id="skin-heading-swarm"><span class="mc-variable Perforce.Manual_Title variable">Helix Swarm Guide</span> (<span class="mc-variable Perforce.VersionNumber variable">2022.1</span>)</div>
                                    <script src="../Resources/google-analytics/gtag.js">
                                    </script>
                                    <script type="text/javascript">/*<![CDATA[*/
			$(document).ready(function(){
			$("#skin-heading-swarm").appendTo("div.logo-wrapper"); 
			});
		/*]]>*/</script>
                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Topic_Toolbar mc-component nocontent" style="mc-topic-toolbar-items: ExpandAll Print RemoveHighlight NextTopic PreviousTopic Forward Back;">
                                        <div class="button-group-container-left">
                                            <button class="button needs-pie print-button" title="Print this topic">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Print">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie previous-topic-button" title="Go to previous heading" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie next-topic-button" title="Go to next heading" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                        </div>
                                    </div>
                                    <div class="sidenav-content">
                                        <div role="main" id="mc-main-content">
                                            <h1 data-mc-autonum=""><a name="Upgrading_a_tarball_installation" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span>Upgrading a tarball installation</h1>
                                            <p>The section describes how to upgrade a  <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> tarball installation to a newer release. </p>
                                            <p>The following process attempts to minimize downtime, but a short period of downtime for <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> users is unavoidable. There should be no downtime for your <span class="mc-variable Perforce.HVE_short variable">Helix server</span>. After a successful upgrade, all <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> users are logged out.</p>
                                            <p>If you are using <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> in a production environment, we encourage you to test this upgrade process in a non-production environment first.</p>
                                            <div class="warning admonition" data-mc-autonum="Warning"><span class="autonumber"><span class="admonition">Warning</span></span>
                                                <ul>
                                                    <li><span class="mc-variable Perforce.Swarm_short variable">Swarm</span> runtime dependencies change between releases, you must check that your system satisfies the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> runtime dependencies before starting the upgrade, see <a href="setup.dependencies.html" title="Runtime Dependencies" alt="Runtime Dependencies" class="MCXref xref">Runtime dependencies</a>. </li>
                                                    <li><a href="#" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open glossaryTerm MCTextPopupHotSpot_" glossTerm="Glossary_swarm.Term21">P4PHP<img class="MCHelpControl_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /><span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"> </span>The PHP interface to the Helix API, which enables you to write PHP code that interacts with a Helix server machine.</span></a> should be upgraded to the version included in the new <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> release. <ul><li>If you have already configured PHP to use the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>-provided <span class="mc-variable Perforce.P4PHP variable">P4PHP</span> (<a href="setup_php.html">as recommended</a>), this happens automatically. </li><li>If you have manually installed <span class="mc-variable Perforce.P4PHP variable">P4PHP</span> in some other fashion, configure <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> to use the version of <span class="mc-variable Perforce.P4PHP variable">P4PHP</span> included in the new <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> tarball before you perform any of the upgrade steps below. See <a href="setup_php.html" title="PHP Configuration" alt="PHP Configuration" class="MCXref xref">PHP configuration</a> for details. </li></ul><p><span style="font-weight: bold;" class="mc-variable Perforce.Swarm_short variable">Swarm</span><b> package, OVA and tarball installations:</b> 2 versions of <span class="mc-variable Perforce.P4PHP variable">P4PHP</span> are supplied for each PHP 7 version supported by <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>. They are located in the <span class="code_clearBackground">p4-bin/bin.linux26x86_64</span> directory.</p><ul><li><span class="code_clearBackground">perforce-php7x.so</span> compatible with systems using SSL 1.0.2</li><li><span class="code_clearBackground">perforce-php7x-ssl1.1.1.so</span>  compatible with systems using SSL 1.1.1 (by default Ubuntu 18.04 and Ubuntu 20.04 use SSL&#160;1.1.1) </li></ul><p>Where <span class="code_clearBackground">x</span> is the version of PHP 7.</p><p>If the <span class="code_clearBackground">perforce.ini</span> file is not pointing at the correct version of <span class="mc-variable Perforce.P4PHP variable">P4PHP</span> and you connect to an SSL&#160;enabled <span class="mc-variable Perforce.Helix_short variable">Helix server</span>: </p><ul><li>The <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> web-page will not load and you might see a <span class="code_clearBackground">Connection Reset</span> error. </li><li>There might be an <span class="code_clearBackground">undefined symbol: SSLeay</span> message in the Apache error log</li></ul></li>
                                                    <li>
                                                        <p>Review the PHP&#160;requirements before you upgrade <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>, see <a href="setup.dependencies.html#setup.dependencies.php" class="MCXref xref">PHP</a>. </p>
                                                    </li>
                                                    <li>Review the <span class="mc-variable Perforce.HVE_short variable">Helix server</span> requirements before you upgrade <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>, see <a href="setup.dependencies.html#setup.dependencies.server" title="Helix server Requirements" alt="Helix server Requirements" class="MCXref xref">Helix Core server requirements</a>. </li>
                                                    <li><span class="mc-variable Perforce.Helix_short variable">Helix server</span> 2020.1 and later, permissions have changed for viewing and <a href="https://www.perforce.com/manuals/cmdref/Content/CmdRef/p4_stream.html#Private" target="_blank" title="Link to Private editing of streams in the Helix Core Server Administrator Guide" alt="Link to Private editing of streams in the Helix Core Server Administrator Guide">editing stream spec files</a> in <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>. To view and edit stream spec files in <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>, the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> user must have <i>admin</i> permissions for the entire depot <span class="code_clearBackground">//...</span></li>
                                                </ul>
                                            </div>
                                            <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                <ul>
                                                    <li>
                                                        <p>If you are upgrading from <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2017.2 or earlier, run the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> index upgrade after you have validated your upgrade. This is the last step of the upgrade and ensures that the review activity history is displayed in the correct order on the <a href="basics.dashboard.html" title="Dashboard" alt="Dashboard" data-mc-conditions="Perforce.Swarm">Dashboard</a>, and <a href="code_reviews.list.html" title="Review List" alt="Review List" data-mc-conditions="Perforce.Swarm">Reviews list</a> pages. </p>
                                                    </li>
                                                    <li>
                                                        <p>If you are upgrading from <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2020.2 or earlier and have <span class="code_clearBackground">userids</span> that contain the forward slash (/) character, add <span class="code_clearBackground">AllowEncodedSlashes NoDecode</span> to the <span class="code_clearBackground">VirtualHost</span> block of your <span class="code_clearBackground">/etc/apache2/sites-enabled/perforce-swarm-site.conf</span> file. For more information about the VirtualHost block, see <a href="setup.apache.html" class="MCXref xref">Apache configuration</a>.</p>
                                                    </li>
                                                </ul>
                                            </div>
                                            <h2 data-mc-autonum=""><a name="PHP_7.x_and_Apache_2.4_installation" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span>PHP 7.x and Apache 2.4 installation</h2>
                                            <p>CentOS and RHEL do not have PHP 7.x and Apache 2.4 by default so you must upgrade your system before you can upgrade <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>. This process is only required the first time you upgrade to PHP 7.x. If you have already upgraded to PHP 7.x and Apache 2.4, see <a href="#setup-upgrade-upgrade_tarball_configure_Redis" class="MCXref xref">Configure Redis  on the Swarm machine</a>.</p>
                                            <p>Carry out the following steps: </p>
                                            <div class="important admonition" data-mc-autonum="Important "><span class="autonumber"><span class="admonition">Important </span></span>
                                                <ul>
                                                    <li>
                                                        <p>As part of the PHP upgrade process your Apache 2.2 server will be stopped and disabled, if you are currently using the Apache 2.2 server for any other applications they will stop working. You will either need to upgrade these applications to work with PHP 7 and Apache 2.4 or move them to another server. </p>
                                                    </li>
                                                    <li>
                                                        <p><b>CentOS/RHEL 7:</b> Use the   Remi repository configuration package (<span class="code_clearBackground">remi-release-7.rpm</span>) to give <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> access to PHP 7.x. Use the <span class="code_clearBackground">epel-release-latest-7.noarch.rpm</span> repository configuration package to give <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> access to EPEL packages. </p>
                                                    </li>
                                                    <li>
                                                        <p><b>RHEL 8:</b> Use the Remi repository configuration package (<span class="code_clearBackground">remi-release-8.rpm</span>) to give <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> access to PHP 7.x. Use the <span class="code_clearBackground">epel-release-latest-8.noarch.rpm</span> repository configuration package to give <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> access to EPEL packages. </p>
                                                    </li>
                                                    <li>
                                                        <p><span style="font-weight: bold;" class="mc-variable Perforce.Swarm_short variable">Swarm</span><b> 2019.1 to 2020.1:</b> these versions of <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> used PHP packages from the SCL repositories for CentOS/RHEL 7. This was to provide access to more recent versions of PHP than are available as standard on CentOS/RHEL. This required the use of the <span class="code_clearBackground">httpd24-httpd</span> package for Apache. These were all installed into <span class="code_clearBackground">/opt/rh</span></p>
                                                        <p><span style="font-weight: bold;" class="mc-variable Perforce.Swarm_short variable">Swarm</span><b> 2020.2 and later:</b> these versions of <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> uses the Remi repository  for CentOS/RHEL 7 and RHEL 8. This provides PHP 7.4 installed in the standard file system structure. This means that the old <span class="code_clearBackground">httpd24-httpd</span> version of Apache is no longer needed, and the standard system version of Apache is being used again.</p>
                                                        <p>The SCL Apache site configuration file was installed at this location for <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2019.1 to 2020.1:</p>
                                                        <p><span class="code_clearBackground">/opt/rh/httpd24/root/etc/httpd/conf.d/perforce-swarm-site.conf</span>
                                                        </p>
                                                        <p>If this exists when <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> is upgraded to 2020.2 and later, this file is copied to <span class="code_clearBackground">/etc/httpd/conf.d/perforce-swarm-site.conf</span> if there is no file at the destination. It is also re-written to change references from  <span class="code_clearBackground">/var/log/httpd24</span> to <span class="code_clearBackground">/var/log/httpd</span></p>
                                                        <p>If a site configuration file for <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> already exists in <span class="code_clearBackground">/etc/httpd</span>, the copy and re-write is not performed.</p>
                                                        <p>After upgrade, <span class="code_clearBackground">httpd24-httpd</span> is disabled.</p>
                                                    </li>
                                                    <li>
                                                        <p>To avoid seeing the Apache HTTP server  Linux test page when you start the Apache server, comment out the content of the <span class="code_clearBackground">welcome.conf</span> file located in the <span class="code_clearBackground">/etc/httpd/conf.d/</span> directory. </p>
                                                    </li>
                                                    <li>
                                                        <p>To avoid loading the Apache HTTP server example configuration instead of the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> configuration when the Apache server starts, rename the <span class="code_clearBackground">autoindex.conf</span> file located in the <span class="code_clearBackground">/etc/httpd/conf.d/</span> directory to <span class="code_clearBackground">z-autoindex.conf</span> or similar. This is required because Apache runs the first conf file it finds in the <span class="code_clearBackground">/etc/httpd/conf.d/</span> directory (alphabetical order) and that must be the   <span class="code_clearBackground">perforce-swarm-site.conf</span> file. </p>
                                                    </li>
                                                </ul>
                                            </div>
                                            <p>This section describes how to install PHP 7.x and Apache 2.4 on your system using a repository .</p>
                                            <ol>
                                                <li value="1">
                                                    <p>This process is only required the first time you upgrade to PHP 7.x. Install PHP 7.x and migrate the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Apache configuration to use Apache 2.4. .</p>
                                                    <p>Follow the instructions for your OS distribution, see <a href="#Setup-update-tarball_centos-rhel-7">CentOS/REHL 7</a> or <a href="#Setup-upgrade-tarball_centos-rhel-8">RHEL 8</a> below:</p>
                                                    <ul>
                                                        <li>
                                                            <p><a name="Setup-update-tarball_centos-rhel-7"></a><b>CentOS/RHEL 7</b> (run these commands as root):</p>
                                                        </li>
                                                        <p>
                                                            <ol style="list-style-type: lower-alpha;">
                                                                <li style="font-weight: normal;" value="1">Deploy the <span class="code">epel-release-latest-7.noarch.rpm</span> repository configuration package to give <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> access to EPEL packages:</li>
                                                                <p><span class="code">yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span>
                                                                </p>
                                                                <li style="font-weight: normal;" value="2">Deploy the Remi repository configuration package to give <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> access to PHP 7.x (only required the first time you upgrade to PHP 7.x): </li>
                                                                <p><span class="code">yum install https://rpms.remirepo.net/enterprise/remi-release-7.rpm</span>
                                                                </p>
                                                                <li value="3">Install the <span class="code">yum-utils</span> package to give access to the <span class="code_clearBackground">yum-config-manager</span> command:</li>
                                                                <p><span class="code">yum install yum-utils</span>
                                                                </p>
                                                                <li value="4">
                                                                    <p>Enable the optional channel for some dependencies:</p>
                                                                </li>
                                                                <p><span class="code">subscription-manager repos --enable=rhel-7-server-optional-rpms</span>
                                                                </p>
                                                                <li value="5">Install the <b>Default/Single version</b> of PHP:<ol style="list-style-type: lower-roman;"><li value="1">Disable <span class="code_clearBackground">remi-php*</span>:  </li><p><span class="code">yum-config-manager --disable 'remi-php*'</span></p><li value="2">Enable PHP 7.4: </li><p><span class="code">yum-config-manager --enable   remi-php74</span></p><li value="3">Run an upgrade for PHP: </li><p><span class="code">yum update</span></p></ol></li>
                                                                <p>
                                                                    <div class="important admonition" data-mc-autonum="Important "><span class="autonumber"><span class="admonition">Important </span></span>
                                                                        <p>If you are upgrading from <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2019.3 to <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2021.1 or later, remove the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> PHP&#160;7.1 files:</p>
                                                                        <p><span class="code">yum remove $(yum list installed | grep php71 | awk '{print $1}')</span>
                                                                        </p>
                                                                    </div>
                                                                </p>
                                                                <li value="6">If you are upgrading from Apache 2.2, disable your Apache 2.2 HTTP&#160;server so that is does not automatically start: </li>
                                                                <p><span class="code">systemctl disable httpd</span>
                                                                </p>
                                                                <li value="7">If you are upgrading from Apache 2.2, stop your Apache 2.2 HTTP server:</li>
                                                                <p><span class="code">systemctl stop httpd</span>
                                                                </p>
                                                                <li value="8">If you are upgrading from PHP 7.2, copy the <span class="code">30-perforce.ini</span> file to <span class="code">/etc/php.d/</span> directory, this step also changes the <span class="code">ini</span> filename to <span class="code">perforce.ini</span>:</li>
                                                                <p><span class="code">cp /etc/opt/rh/rh-php72/php.d/30-perforce.ini /etc/php.d/perforce.ini</span>
                                                                </p>
                                                                <li value="9">If you are upgrading from PHP 7.2, replace the PHP 7.2 references with PHP&#160;7.4 in the <span class="code">perforce.ini</span> file using the <span class="code">sed</span> command:</li>
                                                                <p><span class="code">sed -i "s/72/74/g" /etc/php.d/perforce.ini</span>
                                                                </p>
                                                                <li value="10">If you have any special <span class="code">php.ini</span> configuration options set, copy the <span class="code">php.ini</span> file to the <span class="code">/etc/php.d/</span> directory, for example:</li>
                                                                <p><span class="code">cp /etc/opt/rh/rh-php72/php.d/php.ini /etc/php.d/php.ini</span>
                                                                </p>
                                                                <li value="11">Copy the <span class="code">perforce-swarm-site.conf</span> file to the <span class="code">/etc/httpd/conf.d/</span> directory if it is not already in there, for example:</li>
                                                                <p><span class="code">cp  /opt/rh/httpd24/root/etc/httpd/conf.d/perforce-swarm-site.conf /etc/httpd/conf.d/perforce-swarm-site.conf</span>
                                                                </p>
                                                                <li value="12">Replace the <span class="code">/log/httpd24</span>  filepath with <span class="code">/log/httpd/</span> in the <span class="code">perforce-swarm-site.conf</span> file using the <span class="code">sed</span> command: </li>
                                                                <p><span class="code">sed -i "s#/log/httpd24/#/log/httpd/#g" /etc/httpd/conf.d/perforce-swarm-site.conf</span>
                                                                </p>
                                                                <li value="13">Enable your Apache 2.4 HTTP&#160;server so that it automatically starts:</li>
                                                                <p><span class="code">systemctl enable httpd</span>
                                                                </p>
                                                                <li value="14">Start the Apache 2.4 HTTP&#160;server: </li>
                                                                <p><span class="code">systemctl start httpd</span>
                                                                </p>
                                                                <li value="15">Check that SELinux  is working correctly for your system. For instructions on configuring SELinux on CentOS/RHEL, see <a href="setup-package_centos-rhel.html#Setup-package_selinux-config" class="MCXref xref">SELinux configuration</a>.</li>
                                                            </ol>
                                                        </p>
                                                        <li>
                                                            <p><a name="Setup-upgrade-tarball_centos-rhel-8"></a><b>RHEL 8</b> (run these commands as root):</p>
                                                            <ol style="list-style-type: lower-alpha;">
                                                                <li style="font-weight: normal;" value="1">Deploy the <span class="code">epel-release-latest-8.noarch.rpm</span> repository configuration package to give <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> access to EPEL packages:</li>
                                                                <p><span class="code">dnf install https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm</span>
                                                                </p>
                                                                <li style="font-weight: normal;" value="2">Deploy the Remi repository configuration package to give <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> access to PHP 7.x (only required the first time you upgrade to PHP 7.x): </li>
                                                                <p><span class="code">dnf install https://rpms.remirepo.net/enterprise/remi-release-8.rpm</span>
                                                                </p>
                                                                <li value="3">Install the <span class="code">yum-utils</span> package to give access to the <span class="code_clearBackground">yum-config-manager</span> command:</li>
                                                                <p><span class="code">dnf install yum-utils</span>
                                                                </p>
                                                                <li value="4">
                                                                    <p>Enable the optional channel for some dependencies:</p>
                                                                </li>
                                                                <p>
                                                                    <p><span class="code">subscription-manager repos --enable=rhel-8-server-optional-rpms</span>
                                                                    </p>
                                                                </p>
                                                                <li value="5">Install the <b>Default/Single version</b> of PHP:<ol style="list-style-type: lower-roman;"><li value="1">Enable the module stream for PHP 7.4:  </li><p><span class="code">dnf module reset php</span></p><li value="2">Install PHP 7.4: </li><p><span class="code">dnf module install php:remi-7.4</span></p><li value="3">Run an upgrade for PHP: </li><p><span class="code">dnf update</span></p></ol></li>
                                                                <p>
                                                                    <div class="important admonition" data-mc-autonum="Important "><span class="autonumber"><span class="admonition">Important </span></span>
                                                                        <p>If you are upgrading from <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2019.3 to <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2021.1 or later, remove the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> PHP&#160;7.1 files:</p>
                                                                        <p><span class="code">yum remove $(yum list installed | grep php71 | awk '{print $1}')</span>
                                                                        </p>
                                                                    </div>
                                                                </p>
                                                                <li value="6">If you are upgrading from Apache 2.2, disable your Apache 2.2 HTTP&#160;server so that is does not automatically start: </li>
                                                                <p><span class="code">systemctl disable httpd</span>
                                                                </p>
                                                                <li value="7">If you are upgrading from Apache 2.2, stop your Apache 2.2 HTTP server:</li>
                                                                <p><span class="code">systemctl stop httpd</span>
                                                                </p>
                                                                <li value="8">If you are upgrading from PHP 7.2, copy the <span class="code">30-perforce.ini</span> file to <span class="code">/etc/php.d/</span> directory, this step also changes the <span class="code">ini</span> filename to <span class="code">perforce.ini</span>:</li>
                                                                <p><span class="code">cp /etc/opt/rh/rh-php72/php.d/30-perforce.ini /etc/php.d/perforce.ini</span>
                                                                </p>
                                                                <li value="9">If you are upgrading from PHP 7.2, replace the PHP 7.2 references with PHP&#160;7.4 in the <span class="code">perforce.ini</span> file using the <span class="code">sed</span> command:</li>
                                                                <p><span class="code">sed -i "s/72/74/g" /etc/php.d/perforce.ini</span>
                                                                </p>
                                                                <li value="10">If you have any special <span class="code">php.ini</span> configuration options set, copy the <span class="code">php.ini</span> file to the <span class="code">/etc/php.d/</span> directory, for example:</li>
                                                                <p><span class="code">cp /etc/opt/rh/rh-php72/php.d/php.ini /etc/php.d/php.ini</span>
                                                                </p>
                                                                <li value="11">Copy the <span class="code">perforce-swarm-site.conf</span> file to the <span class="code">/etc/httpd/conf.d/</span> directory if it is not already in there, for example:</li>
                                                                <p><span class="code">cp  /opt/rh/httpd24/root/etc/httpd/conf.d/perforce-swarm-site.conf /etc/httpd/conf.d/perforce-swarm-site.conf</span>
                                                                </p>
                                                                <li value="12">Replace the <span class="code">/log/httpd24</span>  filepath with <span class="code">/log/httpd/</span> in the <span class="code">perforce-swarm-site.conf</span> file using the <span class="code">sed</span> command: </li>
                                                                <p><span class="code">sed -i "s#/log/httpd24/#/log/httpd/#g" /etc/httpd/conf.d/perforce-swarm-site.conf</span>
                                                                </p>
                                                                <li value="13">Enable your Apache 2.4 HTTP&#160;server so that it automatically starts:</li>
                                                                <p><span class="code">systemctl enable httpd</span>
                                                                </p>
                                                                <li value="14">Start the Apache 2.4 HTTP&#160;server: </li>
                                                                <p><span class="code">systemctl start httpd</span>
                                                                </p>
                                                                <li value="15">Check that SELinux  is working correctly for your system. For instructions on configuring SELinux on CentOS/RHEL, see <a href="setup-package_centos-rhel.html#Setup-package_selinux-config" class="MCXref xref">SELinux configuration</a>.</li>
                                                            </ol>
                                                        </li>
                                                    </ul>
                                                </li>
                                                <li value="2">PHP 7.x and Apache 2.4 are now installed, configure the  <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis service on the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> machine, see <a href="#setup-upgrade-upgrade_tarball_configure_Redis" class="MCXref xref">Configure Redis  on the Swarm machine</a>. </li>
                                            </ol>
                                            <h2 data-mc-autonum=""><a name="Configure_Redis__on_the_Swarm_machine" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span><a name="setup-upgrade-upgrade_tarball_configure_Redis"></a>Configure Redis  on the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> machine</h2>
                                            <p>Follow the instructions for the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> version you are upgrading from:</p>
                                            <ul>
                                                <li>
                                                    <p><a href="#setup-upgrade_tarball-redis-19-1-earlier" class="MCXref xref">Upgrade from Swarm 2019.1 and earlier</a>
                                                    </p>
                                                </li>
                                                <li>
                                                    <p><a href="#setup-upgrade_tarball-redis-19--2-later" class="MCXref xref">Upgrade from Swarm 2019.2 and later</a>
                                                    </p>
                                                </li>
                                            </ul>
                                            <h3 data-mc-autonum=""><a name="Upgrade_from_Swarm_2019.1_and_earlier" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span><a name="setup-upgrade_tarball-redis-19-1-earlier"></a>Upgrade from <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2019.1 and earlier</h3>
                                            <p><span class="mc-variable Perforce.Swarm_short variable">Swarm</span> requires Redis to manage its caches and by default <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> uses its own Redis server  on the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> machine. <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> caches data from the <span class="mc-variable Perforce.Helix_short variable">Helix server</span> to improve  the performance of common searches in <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> and to reduce the load on the <span class="mc-variable Perforce.Helix_short variable">Helix server</span>.  Redis is included in the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Tarball installation. </p>
                                            <p>This section describes how to configure the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis service on the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> machine. Do not change the default values of the following configuration files if you are using the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server. </p>
                                            <div class="tip admonition" data-mc-autonum="Tip "><span class="autonumber"><span class="admonition">Tip </span></span>
                                                <p>If required, you can use your own Redis server instead of the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server. For instructions on how to configure <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> to use your own Redis server, see <a href="setup.post.html#setup.post.using_your_redis_server" class="MCXref xref">Use your own Redis server</a>.</p>
                                            </div>
                                            <p><span class="mc-variable Perforce.Swarm_short variable">Swarm</span> has two Redis binaries in <i><span href="admin.swarm_root.htm" style="font-weight: bold;" class="code_clearBackground">SWARM_ROOT</span></i><span class="code_clearBackground">/p4-bin/bin.linux26x86_64/</span>:</p>
                                            <ul>
                                                <li><span class="code_clearBackground">redis-server-swarm</span>
                                                </li>
                                                <li><span class="code_clearBackground">redis-cli-swarm</span>
                                                </li>
                                            </ul>
                                            <ol>
                                                <li value="1">Configure the Redis cache database, enter the following details in the <span class="code_clearBackground">redis-server.conf</span> file in <span class="code_clearBackground">/opt/perforce/etc/</span>: </li><pre lang="php" class="programlisting" xml:space="preserve">
bind 127.0.0.1
port 7379
supervised auto
save ""
dir /opt/perforce/swarm/redis
</pre>
                                                <p style="font-weight: bold;">Default values:</p>
                                                <div class="tip admonition" data-mc-autonum="Tip "><span class="autonumber"><span class="admonition">Tip </span></span>
                                                    <ul>
                                                        <li>The default settings are shown below, the <span class="code_clearBackground">redis-server.conf</span> file contains more detailed information about the Redis configuration for <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>. </li>
                                                        <li>On <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> systems with a large number of users, groups, and projects, start-up time can be improved by persisting the memory cache. You can persist the memory cache by disabling background saves and enabling append saves, see the <span class="code_clearBackground">redis-server.conf</span> file comments for detailed information.  </li>
                                                    </ul>
                                                </div>
                                                <ul>
                                                    <li><span class="code">bind 127.0.0.1</span> - Redis server IP&#160;address (loopback interface)</li>
                                                    <li><span class="code">port 7379</span> - Redis server port number</li>
                                                    <li><span class="code">supervised auto</span> - detects the use of <span class="code_clearBackground">upstart</span> or <span class="code_clearBackground">systemd</span> automatically to signal that the process is ready to use the supervisors</li>
                                                    <li><span class="code">save ""</span> - background saves disabled, recommended. </li>
                                                    <li><span class="code">dir /opt/perforce/swarm/redis</span> - the directory the Redis cache database is stored in. </li>
                                                </ul>
                                                <div class="tip admonition" data-mc-autonum="Tip "><span class="autonumber"><span class="admonition">Tip </span></span>
                                                    <p>To fine-tune your Redis server settings,  make your changes in the Laminas Redis adapter. For information about the Laminas Redis adapter, see the <a href="https://docs.laminas.dev/laminas-cache/storage/adapter/#the-redis-adapter" target="_blank" title="Link to https://docs.laminas.dev/laminas-cache/storage/adapter/#the-redis-adapter" alt="Link to https://docs.laminas.dev/laminas-cache/storage/adapter/#the-redis-adapter">Laminas Redis Adapter documentation</a>.</p>
                                                </div>
                                                <li value="2">The Redis cache database must be running before <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> starts so we recommend setting it up as a service so that it starts automatically at boot time. </li>
                                                <p>The following example script will:</p>
                                                <ul>
                                                    <li>run the Redis service as the <span class="mc-variable Perforce.Company_short variable">Perforce</span> user</li>
                                                    <li>use the configuration file <span class="code_clearBackground">in /opt/perforce/etc/redis-server.conf</span></li>
                                                    <li>assume the database server is installed in <span class="code_clearBackground">/opt/perforce/swarm/p4-bin/bin.linux26x86_64/</span></li>
                                                </ul>
                                                <p>To configure Redis as a service, add a script with the following content in <span class="code_clearBackground">/etc/systemd/system</span></p>
                                                <p><span class="code_clearBackground">redis-server-swarm.service</span>
                                                </p>
                                                <p>
                                                    <p><pre lang="yaml" class="programlisting" xml:space="preserve">
[Unit]
Description=Redis Server for Swarm
After=network.target

[Service]
ExecStart=/opt/perforce/swarm/p4-bin/bin.linux26x86_64/redis-server-swarm /opt/perforce/etc/redis-server.conf
ExecStop=/opt/perforce/swarm/p4-bin/bin.linux26x86_64/redis-cli-swarm shutdown
Restart=always
RestartSec=10
StandardOutput=syslog
StandardError=syslog
SyslogIndentifier=redis
User=perforce
	Group=perforce
 
[Install]
WantedBy=multi-user.target
</pre>
                                                    </p>
                                                </p>
                                                <li value="3">Create the <code class="code_clearBackground"><i><a href="admin.swarm_root.html">SWARM_ROOT</a></i>/data/config.php</code> file if it does not already exist. The <span class="code">redis</span> block of the <code class="code_clearBackground"><i><a href="admin.swarm_root.html">SWARM_ROOT</a></i>/data/config.php</code> file contains the <span class="code">password</span>, <span class="code">namespace</span>, <span class="code">host</span> and <span class="code">port</span> details of the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server: </li><pre lang="php" class="programlisting" xml:space="preserve">
&lt;?php
    // this block should be a peer of 'p4'
    'redis' =&gt; array(
        'options' =&gt; array(
            'password' =&gt; null, // Defaults to null
            'namespace' =&gt; 'Swarm',
            'server' =&gt; array(
                'host' =&gt; 'localhost', // Defaults to 'localhost' or enter your Redis server hostname
                'port' =&gt; '7379', // Defaults to '7379 or enter your Redis server port
            ),            
        ),
        'items_batch_size' =&gt; 100000,
        'check_integrity' =&gt; '03:00', // Defaults to '03:00' Use one of the following two formats: 
                                      // 1) The time of day that the integrity check starts each day. Set in 24 hour format with leading zeros and a : separator
                                      // 2) The number of seconds between each integrity check. Set as a positive integer. Specify '0' to disable the integrity check.
        'population_lock_timeout' =&gt; 300, // Timeout for initial cache population. Defaults to 300 seconds. 
    ),
</pre>
                                                <p style="font-weight: bold;">Configurables:</p>
                                                <ul>
                                                    <li><span class="code">password</span>: Redis server password. Defaults to <span class="code">null</span> and should be left at default if using the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server. </li>
                                                    <li><span class="code">namespace</span>: the prefix  used for key values in the Redis cache. Defaults to <span class="code">Swarm</span> and should be left at default if using the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server. </li>
                                                    <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                        <p>If you have multiple-<span class="mc-variable Perforce.Swarm_short variable">Swarm</span> instances running against a single Redis server,  each <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> server must use a different Redis <span class="code_clearBackground">namespace</span>. This enables the cache data for the individual <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> instances to be identified. The <span class="code_clearBackground">namespace</span> is limited to ≤ 128 characters.</p>
                                                        <p>If one or more of your <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> instances is connected to multiple-<span class="mc-variable Perforce.Helix_short variable">Helix server</span>s, the Redis <span class="code_clearBackground">namespace</span>   includes the <span class="code_clearBackground">server label</span> and the character limit is reduced to ≤ 127 characters, see <a href="admin_multiple_p4d_config.html" class="MCXref xref">Multiple-Helix server instances</a>.</p>
                                                    </div>
                                                    <li><span class="code">host</span>: Redis server hostname. Defaults to <span class="code">localhost</span> and should be left at default if using the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server. </li>
                                                    <li><span class="code">port</span>: Redis server port number. Defaults to <span class="code">7379</span>. <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> uses port <span class="code">7379</span> as its default to avoid clashing with other Redis servers that might be on your network. It should be left at default if using the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server. The default port for a non-<span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server is <span class="code">6379</span>. </li>
                                                    <li><span class="code">items_batch_size</span>: Maximum number of key/value pairs allowed in an <span class="code_clearBackground">mset</span> call to Redis. Sets exceeding this will be batched according to this maximum for efficiency. Defaults to <span class="code">100000</span>. </li>
                                                    <p>
                                                        <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                            <p>The default value of <span class="code_clearBackground">100000</span> was chosen to strike a balance between efficiency and project data complexity. This value should not normally need to be changed, contact support before making a change to this value. </p>
                                                        </div>
                                                    </p>
                                                    <li><span class="code">check_integrity</span>: In some circumstances, such as when changes are made in the <span class="mc-variable Perforce.Helix_short variable">Helix server</span> when <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> is down or if errors occur during updates, the Redis cache can get out of sync with the <span class="mc-variable Perforce.Helix_short variable">Helix server</span>. <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> can run a regular integrity check to make sure that the Redis caches and <span class="mc-variable Perforce.Helix_short variable">Helix server</span> are in sync. If an integrity check finds an out of sync cache file, <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> automatically updates the data in that cache.</li>
                                                    <p>The <span class="code">check_integrity</span> configurable specifies when the Redis cache integrity check is run. Set as a specific time of day (24 hour format with leading zeros) or a number of seconds (positive integer) between checks. Disable the integrity check with <span class="code">'0'</span>. Defaults to <span class="code">'03:00'</span>. </p>
                                                    <li><span class="code">population_lock_timeout</span>: specifies the timeout, in seconds, for initial cache population. If you have a large <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> system, increase this time if the initial cache population times out. Defaults to <span class="code">300</span> seconds. </li>
                                                </ul>
                                            </ol>
                                            <p>Now that the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis service is configured for the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> machine, start your <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> upgrade, see <a href="#setup-upgrade-swarm_tar" class="MCXref xref">Upgrade Swarm</a>.</p>
                                            <h3 data-mc-autonum=""><a name="Upgrade_from_Swarm_2019.2_and_later" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span><a name="setup-upgrade_tarball-redis-19--2-later"></a>Upgrade from <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2019.2 and later</h3>
                                            <p><span class="mc-variable Perforce.Swarm_short variable">Swarm</span> requires Redis to manage its caches and by default <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> uses its own Redis server  on the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> machine. <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> caches data from the <span class="mc-variable Perforce.Helix_short variable">Helix server</span> to improve  the performance of common searches in <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> and to reduce the load on the <span class="mc-variable Perforce.Helix_short variable">Helix server</span>.  Redis is included in the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Tarball installation. </p>
                                            <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                <p>If you are using your own  Redis server instead of the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server, upgrade your Redis server to the version supplied with your <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> upgrade. </p>
                                            </div>
                                            <p><span class="mc-variable Perforce.Swarm_short variable">Swarm</span> has two Redis binaries  in <i><span href="admin.swarm_root.htm" style="font-weight: bold;" class="code_clearBackground">SWARM_ROOT</span></i><span class="code_clearBackground">/p4-bin/bin.linux26x86_64/</span>: </p>
                                            <ul>
                                                <li><span class="code_clearBackground">redis-server-swarm</span>
                                                </li>
                                                <li><span class="code_clearBackground">redis-cli-swarm</span>
                                                </li>
                                            </ul>
                                            <p>If the Redis binaries supplied with your new version of <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> have been updated, your Redis server is automatically upgraded to the new Redis server version. Your original Redis configuration files will not be changed. Do not change the default values of the Redis configuration files if you are using the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis server. </p>
                                            <p><b>Restart the Redis server:</b>
                                            </p>
                                            <p>If the Redis binaries have been updated and you are <a href="setup.redis.html" title="running Redis as a service" alt="running Redis as a service">running Redis as a service</a> (recommended), you must restart the Redis server to use the new Redis server version.</p>
                                            <ol>
                                                <li value="1">Run the following command to restart the Redis server:</li>
                                                <p><span class="code">systemctl restart redis-server-swarm</span>
                                                </p>
                                                <li value="2">You are now running the updated Redis server version. </li>
                                                <p>
                                                    <div class="tip admonition" data-mc-autonum="Tip "><span class="autonumber"><span class="admonition">Tip </span></span>
                                                        <p>On <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> systems with a large number of users, groups, and projects, start-up time can be improved by persisting the memory cache. You can persist the memory cache by disabling background saves and enabling append saves, see the <span class="code_clearBackground">redis-server.conf</span> file comments for detailed information.  </p>
                                                    </div>
                                                </p>
                                                <li value="3">
                                                    <p>Now that the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Redis service is configured for the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> machine, start your <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> upgrade, see <a href="#setup-upgrade-swarm_tar" class="MCXref xref">Upgrade Swarm</a>. </p>
                                                </li>
                                            </ol>
                                            <h2 data-mc-autonum=""><a name="Upgrade_Swarm" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span><a name="setup-upgrade-swarm_tar"></a>Upgrade <span class="mc-variable Perforce.Swarm_short variable">Swarm</span></h2>
                                            <p>The steps in this section describe how to upgrade <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> using the provided archive file. <code>SWARM_ROOT</code> refers to the current <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> installation.</p>
                                            <div class="tip admonition" data-mc-autonum="Tip "><span class="autonumber"><span class="admonition">Tip </span></span>
                                                <p>For OVA installations,  <code>SWARM_ROOT</code> is <code class="code_clearBackground">/opt/perforce/swarm</code>. </p>
                                            </div>
                                            <ol>
                                                <li value="1">
                                                    <p>Download the new TAR file from <a href="https://www.perforce.com/downloads/helix-swarm" target="_blank" title="Link to https://www.perforce.com/downloads/helix-swarm" alt="Link to https://www.perforce.com/downloads/helix-swarm">https://www.perforce.com/downloads/helix-swarm</a>.</p>
                                                </li>
                                                <li value="2">
                                                    <p>Expand the new <code class="code_clearBackground">swarm.tgz</code>:</p>
                                                    <p><span class="code">tar -zxf swarm.tgz</span>
                                                    </p>
                                                    <p>The contents of <code>swarm.tgz</code> are expanded into a top-level folder named <code class="code_clearBackground">swarm-<i>version</i></code>, where <code class="code_clearBackground" style="font-style: italic;">version</code> corresponds to the version downloaded. This directory is identified as <code class="code_clearBackground">SWARM_NEW</code> below.</p>
                                                </li>
                                                <li value="3">
                                                    <p>Move <code class="code_clearBackground">SWARM_NEW</code> to be a peer of <code class="code_clearBackground">SWARM_ROOT</code>:</p>
                                                    <p xml:space="preserve"><span class="code">mv SWARM_NEW SWARM_ROOT/../</span>
                </p>
                                                </li>
                                                <li value="4">
                                                    <p>Copy the <code class="code_clearBackground"><i><a href="admin.swarm_root.html">SWARM_ROOT</a></i>/data/config.php</code> file from <code>SWARM_ROOT</code> to <code class="code_clearBackground">SWARM_NEW</code>:</p>
                                                    <p xml:space="preserve"><span class="code">cp -p SWARM_ROOT/data/config.php SWARM_NEW/data/</span>
                </p>
                                                </li>
                                                <li value="5">
                                                    <p>Create the queue token directory:</p>
                                                    <p xml:space="preserve"><span class="code">mkdir SWARM_NEW/data/queue</span>
                </p>
                                                </li>
                                                <li value="6">
                                                    <p>Copy the existing trigger token(s):</p>
                                                    <p><span class="code">sudo cp -pR SWARM_ROOT/data/queue/tokens SWARM_NEW/data/queue/</span>
                                                    </p>
                                                </li>
                                                <li value="7">
                                                    <p>Assign correct ownership to the new <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>'s data directory:</p>
                                                    <p xml:space="preserve"><span class="code">sudo chown -R www-data SWARM_NEW/data</span>
                </p>
                                                    <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                        <p>The <span class="code_clearBackground">www-data</span> user above is an example of what the web server user name might be, and can vary based on distribution or customization. For example, the user is typically <span class="code_clearBackground">apache</span> for Red Hat/CentOS and  <span class="code_clearBackground">www-data</span> for Debian/Ubuntu.</p>
                                                    </div>
                                                </li>
                                                <li value="8">
                                                    <p>Update your triggers, see <a href="#setup-upgrade_tarball_triggers" class="MCXref xref">Update your triggers </a>. </p>
                                                </li>
                                            </ol>
                                            <h2 data-mc-autonum=""><a name="Update_your_triggers" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span><a name="setup-upgrade_tarball_triggers"></a>Update your triggers </h2>
                                            <div class="important admonition" data-mc-autonum="Important "><span class="autonumber"><span class="admonition">Important </span></span>
                                                <p>If you are using <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> <span class="mc-variable Perforce.Helix_short variable">Helix server</span> Triggers, the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> <span class="mc-variable Perforce.Helix_short variable">Helix server</span> <span class="mc-variable Perforce.extension variable">extension</span> must not be installed.</p>
                                            </div>
                                            <ol>
                                                <li value="1">
                                                    <p>Copy the new <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> trigger script to your <span class="mc-variable Perforce.HVE_long variable">Helix Core server</span> machine. The trigger script is <code class="code_clearBackground">SWARM_ROOT/p4-bin/scripts/swarm-trigger.pl</code>, and requires installation of Perl 5.08+ (use the latest available) on the <span class="mc-variable Perforce.HVE_short variable">Helix server</span> machine. If <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> is using SSL, then the triggers also require the <code class="code_clearBackground">IO::Socket::SSL</code> Perl module.</p>
                                                    <div class="warning admonition" data-mc-autonum="Warning"><span class="autonumber"><span class="admonition">Warning</span></span>
                                                        <p>Do not overwrite any existing trigger script at this time. Give the script a new name, for example: <code class="code_clearBackground">swarm-trigger-new.pl</code>.</p>
                                                    </div>
                                                </li>
                                                <li value="2">
                                                    <p>Configure the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> trigger script by creating, in the same directory on the <span class="mc-variable Perforce.HVE_short variable">Helix server</span> machine, <code class="code_clearBackground">swarm-trigger.conf</code>. It should contain:</p>
                                                    <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                        <p>If you already have a <code class="code_clearBackground">swarm-trigger.conf</code> file, no additional configuration is required.</p>
                                                    </div><pre class="programlisting" lang="ini" xml:space="preserve"># SWARM_HOST (required)
# Hostname of your Swarm instance, with leading "http://" or "https://".
SWARM_HOST="http://<i>my-swarm-host</i>"

# SWARM_TOKEN (required)
# The token used when talking to Swarm to offer some security. To obtain the
# value, log in to Swarm as a super user and select 'About Swarm' to see the
# token value.
SWARM_TOKEN="<i>MY-UUID-STYLE-TOKEN</i>"

# ADMIN_USER (optional) <b>Do not use if the Workflow feature is enabled (default)</b>
# For enforcing reviewed changes, optionally specify the normal Perforce user
# with admin privileges (to read keys); if not set, will use whatever Perforce
# user is set in environment.
ADMIN_USER=

# ADMIN_TICKET_FILE (optional) <b>Do not use if the Workflow feature is enabled (default)</b>
# For enforcing reviewed changes, optionally specify the location of the
# p4tickets file if different from the default ($HOME/.p4tickets).
# Ensure this user is a member of a group with an 'unlimited' or very long
# timeout; then, manually login as this user from the Perforce server machine to
# set the ticket.
ADMIN_TICKET_FILE=				
										
# VERIFY_SSL (optional)
# If HTTPS is being used on the Swarm web server, then this controls whether
# the SSL certificate is validated or not. By default this is set to 1, which
# means any SSL certificates must be valid. If the web server is using a self
# signed certificate, then this must be set to 0.
# set the ticket.
VERIFY_SSL=1</pre>
                                                    <p>Fill in the required <span class="code">SWARM_HOST</span> and <span class="code">SWARM_TOKEN</span> variables with the configuration from any previous <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> trigger script, typically <code class="code_clearBackground">swarm-trigger.pl</code>. </p>
                                                    <div class="tip admonition" data-mc-autonum="Tip "><span class="autonumber"><span class="admonition">Tip </span></span>
                                                        <p>The <span class="code_clearBackground">ADMIN_USER</span> and <span class="code_clearBackground">ADMIN_TICKET</span> variables were used by the <![CDATA[  ]]><span class="code_clearBackground">'enforce triggers'</span> in <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2019.1 and earlier. They can be removed unless you are explicitly <a href="admin.workflow_configurables.html#admin_workflow_enable">disabling workflow</a> and using the deprecated <span class="code_clearBackground">'enforce triggers'</span>. </p>
                                                    </div>
                                                    <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                        <p><b><span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2015.4 and earlier:</b> <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> trigger script files were available as shell scripts in these earlier <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> versions, typically <code class="code_clearBackground">swarm-trigger.sh</code>. </p>
                                                        <p><span class="mc-variable Perforce.Swarm_short variable">Swarm</span> must now use a Perl trigger script file, typically <code class="code_clearBackground">swarm-trigger.pl</code>. </p>
                                                    </div>
                                                </li>
                                                <li value="3">
                                                    <p><b>On Linux:</b> ensure that the script is executable:</p>
                                                    <p><span class="code">sudo chmod +x swarm-trigger-new.pl</span>
                                                    </p>
                                                </li>
                                                <li value="4">
                                                    <p>Rename the new trigger script:</p>
                                                    <p><b>On Linux:</b>
                                                    </p>
                                                    <p><span class="code">mv swarm-trigger-new.pl swarm-trigger.pl</span>
                                                    </p>
                                                    <p><b>On Windows:</b>
                                                    </p>
                                                    <p><span class="code">ren swarm-trigger-new.pl swarm-trigger.pl</span>
                                                    </p>
                                                </li>
                                                <li value="5">
                                                    <p>Update the triggers in your <span class="mc-variable Perforce.HVE_short variable">Helix server</span>.</p>
                                                    <div class="warning admonition" data-mc-autonum="Warning"><span class="autonumber"><span class="admonition">Warning</span></span>
                                                        <ul>
                                                            <li>
                                                                <p>The <span class="code_clearBackground">swarm.shelvedel shelve-delete</span> trigger line was added to  <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> in version 2018.1 and updated in version 2020.1.</p>
                                                                <ul>
                                                                    <li><b>Upgrading from </b><span style="font-weight: bold;" class="mc-variable Perforce.Swarm_short variable">Swarm</span><b> 2017.4 and earlier:</b> add the <code class="code_clearBackground">swarm.shelvedel shelve-delete</code> trigger line to the <span class="mc-variable Perforce.HVE_short variable">Helix server</span> trigger table if it is not already present, see <a href="setup.perforce.html#setup.perforce.update_server_trigger_table" title="Update  Helix server trigger table" alt="Update  Helix server trigger table" class="MCXref xref"> Update the Helix server triggers table to run the trigger script.</a> </li>
                                                                    <li><b>Upgrading from </b><span style="font-weight: bold;" class="mc-variable Perforce.Swarm_short variable">Swarm</span><b> 2018.x and 2019.x:</b> replace the existing <code class="code_clearBackground">swarm.shelvedel shelve-delete</code> trigger line in the <span class="mc-variable Perforce.HVE_short variable">Helix server</span> trigger table with the one supplied in the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> version you are upgrading to. </li>
                                                                </ul>
                                                            </li>
                                                            <li>
                                                                <p><b>Workflow feature:</b> </p>
                                                                <p>The <a href="workflow.overview.html" data-mc-conditions="Perforce.Swarm">Workflow feature</a> is enabled by default in <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2019.2 and later. The trigger lines required when workflow is enabled are different to those required when workflow is  disabled: </p>
                                                                <ul>
                                                                    <li><b>Workflow feature</b><a href="admin.workflow_configurables.html#admin_workflow_enable" style="font-weight: bold;"> enabled</a><b> (default): </b>
                                                                        <ul>
                                                                            <li>Comment out the <span class="code_clearBackground">swarm.enforce.1</span>, <span class="code_clearBackground">swarm.enforce.2</span>, <span class="code_clearBackground">swarm.strict.1</span>, and <span class="code_clearBackground">swarm.strict.2</span> trigger lines  in the <span class="mc-variable Perforce.HVE_short variable">Helix server</span> trigger table if they are present, see <a href="setup.perforce.html#setup.perforce.update_server_trigger_table" title="Update the Helix server trigger table" alt="Update the Helix server trigger table" class="MCXref xref"> Update the Helix server triggers table to run the trigger script.</a></li>
                                                                            <li>Add the <code class="code_clearBackground">swarm.enforce change-submit</code>,  <code class="code_clearBackground">swarm.strict change-content</code>, and <code class="code_clearBackground">swarm.shelvesub shelve-submit</code>  trigger lines to the <span class="mc-variable Perforce.HVE_short variable">Helix server</span> trigger table if they are not already present, see <a href="setup.perforce.html#setup.perforce.update_server_trigger_table" title="Update the Helix server trigger table" alt="Update the Helix server trigger table" class="MCXref xref"> Update the Helix server triggers table to run the trigger script.</a></li>
                                                                        </ul>
                                                                    </li>
                                                                    <li><b>Workflow feature</b><a href="admin.workflow_configurables.html#admin_workflow_enable" style="font-weight: bold;"> disabled</a><b>:</b>
                                                                        <p>Comment out the <code class="code_clearBackground">swarm.enforce change-submit</code>,  <code class="code_clearBackground">swarm.strict change-content</code>, and <code class="code_clearBackground">swarm.shelvesub shelve-submit</code> trigger lines  in the <span class="mc-variable Perforce.HVE_short variable">Helix server</span> trigger table if they are present, see <a href="setup.perforce.html#setup.perforce.update_server_trigger_table" title="Update the Helix server trigger table" alt="Update the Helix server trigger table" class="MCXref xref"> Update the Helix server triggers table to run the trigger script.</a></p>
                                                                    </li>
                                                                </ul>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <ol style="list-style-type: lower-alpha;">
                                                        <li value="1">
                                                            <p>Run the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> trigger script to capture (using <b>Ctrl+C</b> on Windows and Linux, <b>Command+C</b> on Mac OSX) the trigger lines that should be included in the <span class="mc-variable Perforce.Company_short variable">Perforce</span> trigger table:</p>
                                                            <p><b>On Linux:</b>
                                                            </p>
                                                            <p><span class="code">./swarm-trigger.pl -o</span>
                                                            </p>
                                                            <p><b>On Windows:</b>
                                                            </p>
                                                            <p><span class="code">path/to/perl swarm-trigger.pl -o</span>
                                                            </p>
                                                        </li>
                                                        <li value="2">As a <span class="mc-variable Perforce.Company_short variable">Perforce</span> user with <i>super</i> privileges, update the <span class="mc-variable Perforce.Company_short variable">Perforce</span> trigger table by running <code class="code_clearBackground">p4 triggers</code> command and replacing any <code class="code_clearBackground">swarm.*</code> lines with the previously captured trigger line output (using <b>Ctrl+V</b> on Windows and Linux, <b>Command+V</b> on Mac OSX).</li>
                                                    </ol>
                                                    <div class="important admonition" data-mc-autonum="Important "><span class="autonumber"><span class="admonition">Important </span></span>
                                                        <p>If you previously customized the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> trigger lines, perhaps to apply various <a href="admin.trigger.html" class="MCXref xref">Trigger options</a>, be sure to repeat those customizations within the updated trigger lines. </p>
                                                    </div>
                                                </li>
                                            </ol>
                                            <h2 data-mc-autonum=""><a name="Replace_your_old_Swarm_instance_with_your_new_Swarm_instance" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span>Replace your old <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> instance with your new <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> instance</h2>
                                            <p>
                                                <div class="important admonition" data-mc-autonum="Important "><span class="autonumber"><span class="admonition">Important </span></span>
                                                    <p>Downtime occurs in this step. </p>
                                                </div>
                                            </p>
                                            <p>Replace your old <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> instance with your new <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> instance. Run the following command:</p>
                                            <p><span class="code">sudo apache2ctl stop; mv SWARM_ROOT SWARM.old; mv SWARM_NEW SWARM_ROOT; sudo apache2ctl start</span>
                                            </p>
                                            <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                <p>If you see the following error message when you start <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>, <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> is using the wrong version of <span class="mc-variable Perforce.P4PHP variable">P4PHP</span>. The latest version of <span class="mc-variable Perforce.P4PHP variable">P4PHP</span> is included in the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> tarball but you must configure <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> to use that version of <span class="mc-variable Perforce.P4PHP variable">P4PHP</span>. For instructions about how to configure <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> to use the new version of <span class="mc-variable Perforce.P4PHP variable">P4PHP</span>, see <a href="setup_php.html" title="PHP configuration" alt="PHP configuration" class="MCXref xref">PHP configuration</a>. </p>
                                                <p>
                                                    <img src="../Resources/Images/swarm-error-p4php-version-incorrect_622x460.png" title="P4PHP version error message" alt="Image of the P4PHP version error message" style="width: 622;height: 460;" />
                                                </p>
                                            </div>
                                            <h3 data-mc-autonum=""><a name="Reload_the_Swarm_config_cache" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span>Reload the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> config cache</h3>
                                            <p>As an <i>admin</i> user, delete and reload the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> configuration cache from the <b xmlns="http://docbook.org/ns/docbook">Cache Info</b> tab of the <b xmlns="http://docbook.org/ns/docbook">System Information</b> page. Navigate to the <b xmlns="http://docbook.org/ns/docbook">User id</b> dropdown menu, select <b xmlns="http://docbook.org/ns/docbook">System Information</b>, select the <b xmlns="http://docbook.org/ns/docbook">Cache Info</b> tab, and select <b>Reload Configuration</b>. For more information, see <a href="admin.system_information.html#admin_system_information_cache_info" class="MCXref xref">Cache Info</a>. </p>
                                            <h2 data-mc-autonum=""><a name="Validate_your_upgrade" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span>Validate your upgrade</h2>
                                            <div class="tip admonition" data-mc-autonum="Tip "><span class="autonumber"><span class="admonition">Tip </span></span>
                                                <p>When <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> starts it verifies the Redis cache, during this time you cannot log in to <span class="mc-variable Perforce.Swarm_short variable">Swarm</span>. The time taken to verify the Redis cache depends on the number of users, groups, and projects <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> has. Start-up time can be improved by persisting the memory cache. You can persist the memory cache by disabling background saves and enabling append saves in the <span class="code_clearBackground">redis-server.conf</span> file, see  <a href="admin.redis.html#admin.redis.redis_config_file" class="MCXref xref">Redis server configuration file</a>.</p>
                                            </div>
                                            <p>Check that your new <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> instance is working correctly by doing the following: </p>
                                            <ol>
                                                <li value="1">Create a new changelist that:<ol><li value="1">Contains at least one modified file</li><li value="2"> Contains the <span class="code">#review</span> <a href="admin.review_keyword.html#admin.review_keyword.create_review" title="Link to Review keyword page" alt="Link to Review keyword page">keyword</a> in the changelist description</li></ol></li>
                                                <li value="2">Right click on the new changelist in <span class="mc-variable Perforce.P4V variable">P4V</span> and click <b>Shelve Files...</b></li>
                                                <p>
                                                    <div class="important admonition" data-mc-autonum="Important "><span class="autonumber"><span class="admonition">Important </span></span>
                                                        <p>Do not select <b>Request New <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> Review...</b> because this method uses the API and will not fully test the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> <span class="mc-variable Perforce.Helix_short variable">Helix server</span> <span class="mc-variable Perforce.extension variable">extension</span>. </p>
                                                        <p>This is also true if you are using <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> <span class="mc-variable Perforce.Helix_short variable">Helix server</span> Triggers instead of the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> <span class="mc-variable Perforce.Helix_short variable">Helix server</span> <span class="mc-variable Perforce.extension variable">extension</span>. </p>
                                                    </div>
                                                </p>
                                                <li value="3">Check that a new <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> review is created for the changelist. </li>
                                                <ul>
                                                    <li>If a <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> review is created, the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> <span class="mc-variable Perforce.Helix_short variable">Helix server</span> <span class="mc-variable Perforce.extension variable">extension</span> is working. If you are using <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> <span class="mc-variable Perforce.Helix_short variable">Helix server</span> Triggers instead of the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> <span class="mc-variable Perforce.Helix_short variable">Helix server</span> <span class="mc-variable Perforce.extension variable">extension</span> and the review is created, the triggers are working. </li>
                                                    <li>If a <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> review is not created, see  <a href="setup.validate_install.html#Review" class="MCXref xref">Review not created</a>. </li>
                                                </ul>
                                            </ol>
                                            <h2 data-mc-autonum=""><a name="Swarm_index_upgrade" data-mc-generated-bookmark="TOC"></a><span class="autonumber"><span></span></span><span class="mc-variable Perforce.Swarm_short variable">Swarm</span> index upgrade</h2>
                                            <p>If you are upgrading from <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> 2017.2 or earlier you should run the index upgrade, this ensures that the review activity history is displayed in the correct order on the <a href="basics.dashboard.html" title="Dashboard" alt="Dashboard" data-mc-conditions="Perforce.Swarm">Dashboard</a>, and <a href="code_reviews.list.html" title="Review List" alt="Review List" data-mc-conditions="Perforce.Swarm">Reviews list</a> pages. </p>
                                            <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                <p>If you are upgrading from <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> version 2017.3 or later, the index upgrade step is not required. </p>
                                            </div>
                                            <p>The index upgrade process can be configured to suit your <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> system specifications. See <a href="admin.upgrade_index.html" title="Upgrade index link" alt="Upgrade index link">Upgrade index</a> for details. </p>
                                            <p>Run the upgrade as an <i>Admin</i> user by visiting the following URL: </p><pre class="programlisting" lang="html" xml:space="preserve">http://SWARM-HOST/upgrade</pre>
                                            <div class="note admonition" data-mc-autonum="Note "><span class="autonumber"><span class="admonition">Note </span></span>
                                                <p>After the <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> upgrade, on the first visit to some <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> pages, users might see a message to perform a browser hard refresh. This happens because we are updating the UI and content of some <span class="mc-variable Perforce.Swarm_short variable">Swarm</span> pages, so the user's page cache is no longer valid and requires a hard refresh to load the upgraded page. For example, for Chrome on Windows/Linux  <b>[CTRL]</b>+<b>[F5]</b> and for Chrome on MacOS <b>[Command]</b>+<b>[Shift]</b>+<b>[R]</b>. </p>
                                            </div>
                                            <p>All done!</p>
                                        </div>
                                    </div>
                                    <p class="invisible"><a href="../Shared/SearchTips-swarm.html" class="MCXref xref">Your search for  returned  result(s).</a>
                                    </p>
                                    <p class="invisible"><span class="invisible"><link href="../Resources/Fonts/OpenSans-Regular.ttf" /><link href="../Resources/Fonts/OpenSans-Bold.ttf" /><link href="../Resources/Fonts/OpenSans-BoldItalic.ttf" /><link href="../Resources/Fonts/OpenSans-Italic.ttf" /><link href="../Resources/Fonts/cour.ttf" /><link href="../Resources/Fonts/courbd.ttf" /><link href="../Resources/Fonts/courbi.ttf" /><link href="../Resources/Fonts/couri.ttf" /></span>
                                    </p>
                                    <div class="home-footer">
                                        <div><a href="https://www.perforce.com/support/documentation" target="_blank"><img src="../Resources/FooterImages/Docs_28x28.png" title="View additional product documentation" alt="Additional product documentation" class="FooterIcon" style="width: 28;height: 28;" /></a>
                                        </div>
                                        <div><a href="https://www.perforce.com/support/training" target="_blank"><img src="../Resources/FooterImages/training_28x28.png" title="Visit the Perforce Training portal" alt="Perforce training portal" class="FooterIcon" style="width: 28;height: 28;" /></a>
                                        </div>
                                        <div><a href="https://www.perforce.com/support/video-tutorials" target="_blank"><img src="../Resources/FooterImages/video-tutorials_28x28.png" title="Visit the Perforce video library" alt="Perforce video library" class="FooterIcon" style="width: 28;height: 28;" /></a>
                                        </div>
                                        <div><a href="https://community.perforce.com/s/" target="_blank"><img src="../Resources/FooterImages/KB_28x28.png" title="Visit the Perforce knowledge base" alt=" Perforce knowledge base" class="FooterIcon" style="width: 28;height: 28;" /></a>
                                        </div>
                                        <div><a href="https://www.perforce.com/support" target="_blank"><img src="../Resources/FooterImages/Support_28x28.png" title="Go to Perforce customer support" alt="Perforce customer support" class="FooterIcon" style="width: 28;height: 28;" /></a>
                                        </div>
                                        <div><a href="mailto:manual@perforce.com?subject=Documentation feedback" target="_blank"><img src="../Resources/FooterImages/feedback_28x28.png" title="How can we improve this topic?" alt="Email us at: manual@perforce.com" class="FooterIcon" style="width: 28;height: 28;" /></a>
                                        </div>
                                        <div><a href="http://www.perforce.com/" target="_blank"><img src="../Resources/FooterImages/Perforce-LOGO-WHITE_150x17.png" style="width: 150;height: 17;" alt="" /></a>
                                        </div>
                                    </div>
                                    <script type="text/javascript" src="../Resources/google-code-prettify/prettify.js">
                                    </script>
                                    <script type="text/javascript">/* <![CDATA[ */
    // hookup prettify
    $("pre.programlisting").each(function () {
      var $this = $(this),
          lang = $this.attr("lang");
      if (lang) {
        $this.addClass("lang-" + lang);
       // if (lang !== "bash") 
		// {
        $this.addClass("prettyprint");
        //}
      }
    });
    window.prettyPrint();
    /* ]]> */</script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>